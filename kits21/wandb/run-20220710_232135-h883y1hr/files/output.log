INFO: Starting training:
        Epochs:          {epochs}
        Batch size:      {batch_size}
        Learning rate:   {learning_rate}
        Training size:   {n_train}
        Validation size: {n_val}
        Checkpoints:     {save_checkpoint}
        Device:          {device.type}
        Images scaling:  {img_scale}
        Mixed Precision: {amp}
Epoch 1/1000:   0%|          | 0/10790 [00:00<?, ?img/s]

Epoch 1/1000:   0%|          | 20/10790 [00:07<37:28,  4.79img/s, loss (batch)=1.31]
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000


Epoch 1/1000:   1%|          | 68/10790 [00:11<15:09, 11.79img/s, loss (batch)=0.893]
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 3], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 3], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')

Epoch 1/1000:   1%|          | 92/10790 [00:13<14:54, 11.95img/s, loss (batch)=0.784]
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')

Epoch 1/1000:   1%|          | 116/10790 [00:15<14:52, 11.96img/s, loss (batch)=0.71]
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000

Epoch 1/1000:   1%|▏         | 144/10790 [00:17<14:51, 11.94img/s, loss (batch)=0.665]
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000

Epoch 1/1000:   2%|▏         | 168/10790 [00:19<14:50, 11.93img/s, loss (batch)=0.614]
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000


Epoch 1/1000:   2%|▏         | 216/10790 [00:23<14:50, 11.88img/s, loss (batch)=0.54]
llllll000000000000
tensor([0, 1, 3], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2, 3], device='cuda:0')
llllll000000000000

Epoch 1/1000:   2%|▏         | 240/10790 [00:25<14:48, 11.87img/s, loss (batch)=0.521]
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2, 3], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000

Epoch 1/1000:   2%|▏         | 264/10790 [00:27<14:46, 11.87img/s, loss (batch)=0.495]
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000


Epoch 1/1000:   3%|▎         | 312/10790 [00:31<14:45, 11.83img/s, loss (batch)=0.432]
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2, 3], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000

Epoch 1/1000:   3%|▎         | 328/10790 [00:33<14:45, 11.82img/s, loss (batch)=0.421]
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 3], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')

Epoch 1/1000:   3%|▎         | 352/10790 [00:35<14:43, 11.81img/s, loss (batch)=0.436]
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 3], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 3], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2, 3], device='cuda:0')
llllll000000000000
tensor([0, 1, 3], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')

Epoch 1/1000:   3%|▎         | 376/10790 [00:37<14:43, 11.78img/s, loss (batch)=0.397]
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 3], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')


Epoch 1/1000:   4%|▍         | 424/10790 [00:41<15:46, 10.96img/s, loss (batch)=0.384]
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000

Epoch 1/1000:   4%|▍         | 444/10790 [00:43<15:56, 10.82img/s, loss (batch)=0.357]
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')

Epoch 1/1000:   4%|▍         | 468/10790 [00:45<16:38, 10.34img/s, loss (batch)=0.365]
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')

Epoch 1/1000:   5%|▍         | 488/10790 [00:47<16:55, 10.15img/s, loss (batch)=0.351]
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 3], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000

Epoch 1/1000:   5%|▍         | 508/10790 [00:49<16:43, 10.25img/s, loss (batch)=0.342]
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000

Epoch 1/1000:   5%|▍         | 528/10790 [00:51<16:40, 10.25img/s, loss (batch)=0.355]
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')


Epoch 1/1000:   5%|▌         | 572/10790 [00:56<16:38, 10.23img/s, loss (batch)=0.327]
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')

Epoch 1/1000:   5%|▌         | 592/10790 [00:57<16:29, 10.30img/s, loss (batch)=0.335]
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000

Epoch 1/1000:   6%|▌         | 612/10790 [00:59<16:27, 10.30img/s, loss (batch)=0.318]
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')

Epoch 1/1000:   6%|▌         | 632/10790 [01:02<16:26, 10.30img/s, loss (batch)=0.328]
tensor([0, 1, 2, 3], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')

Epoch 1/1000:   6%|▌         | 656/10790 [01:04<16:23, 10.30img/s, loss (batch)=0.295]
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 3], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000

Epoch 1/1000:   6%|▋         | 676/10790 [01:06<16:22, 10.30img/s, loss (batch)=0.283]
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000

Epoch 1/1000:   6%|▋         | 696/10790 [01:08<16:22, 10.28img/s, loss (batch)=0.297]
llllll000000000000
tensor([0, 1, 3], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000

Epoch 1/1000:   7%|▋         | 716/10790 [01:10<16:22, 10.25img/s, loss (batch)=0.293]
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')

Epoch 1/1000:   7%|▋         | 732/10790 [01:11<16:25, 10.21img/s, loss (batch)=0.286]
tensor([0, 1, 2], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000
tensor([0, 1], device='cuda:0')
llllll000000000000
tensor([0], device='cuda:0')
llllll000000000000
tensor([0, 1, 2], device='cuda:0')
llllll000000000000

Epoch 1/1000:   7%|▋         | 760/10790 [01:14<16:23, 10.20img/s, loss (batch)=0.261]
Traceback (most recent call last):
  File "D:\AI\kits21-master\kits21\train.py", line 197, in <module>
    train_net(net=net,
  File "D:\AI\kits21-master\kits21\train.py", line 85, in train_net
    for batch in train_loader:
  File "C:\Users\OUR\anaconda3\envs\pytorch\lib\site-packages\torch\utils\data\dataloader.py", line 530, in __next__
    data = self._next_data()
  File "C:\Users\OUR\anaconda3\envs\pytorch\lib\site-packages\torch\utils\data\dataloader.py", line 1224, in _next_data
    return self._process_data(data)
  File "C:\Users\OUR\anaconda3\envs\pytorch\lib\site-packages\torch\utils\data\dataloader.py", line 1250, in _process_data
    data.reraise()
  File "C:\Users\OUR\anaconda3\envs\pytorch\lib\site-packages\torch\_utils.py", line 456, in reraise
    raise RuntimeError(msg) from None
RuntimeError: Caught MemoryError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "C:\Users\OUR\anaconda3\envs\pytorch\lib\site-packages\torch\utils\data\_utils\worker.py", line 287, in _worker_loop
    data = fetcher.fetch(index)
  File "C:\Users\OUR\anaconda3\envs\pytorch\lib\site-packages\torch\utils\data\_utils\fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "C:\Users\OUR\anaconda3\envs\pytorch\lib\site-packages\torch\utils\data\_utils\fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "C:\Users\OUR\anaconda3\envs\pytorch\lib\site-packages\torch\utils\data\dataset.py", line 471, in __getitem__
    return self.dataset[self.indices[idx]]
  File "D:\AI\kits21-master\kits21\utils\data_loading4Bone.py", line 78, in __getitem__
    mask = self.load(mask_file[0])
  File "D:\AI\kits21-master\kits21\utils\data_loading4Bone.py", line 57, in load
    return Image.fromarray(np.load(filename))
  File "C:\Users\OUR\anaconda3\envs\pytorch\lib\site-packages\numpy\lib\npyio.py", line 430, in load
    return format.read_array(fid, allow_pickle=allow_pickle,
  File "C:\Users\OUR\anaconda3\envs\pytorch\lib\site-packages\numpy\lib\format.py", line 756, in read_array
    array = numpy.fromfile(fp, dtype=dtype, count=count)
numpy.core._exceptions._ArrayMemoryError: Unable to allocate 1.00 MiB for an array with shape (262144,) and data type int32